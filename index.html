<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Rhythm-keeping task</title>
  <link rel="stylesheet" href="styles/styles.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <!-- <script src="https://cdn.jsdelivr.net/npm/dsp.js/dist/dsp.min.js"></script> -->
</head>
<body>
  <div id="menu">
    <ul>
      <li><a href="#introduction">Introduction</a></li>
      <li><a href="#training">Training</a></li>
      <li><a href="#calibration">Calibration</a></li>
      <!-- <li><a href="#validation">Validation</a></li> -->
    </ul>
    <div style="position: fixed; right: 0; top: 20">
      <button id="reset_page">Reset page</button>
      <button id="toggle_button">Toggle metronome</button>
    </div>
  </div>

  <section id="introduction">
    <h1>Welcome to the Rhythm Keeping exercise.</h1>
    <!-- <div class="spacer"></div> -->
    <!-- <p class="content-section">This is the introduction section of my website.</p> -->
    <p style="align-items:left; padding:0px; font-size:24">
      The rhythm keeping exercise is like playing drums -
      You must tap with your foot on a footpedal located under your desk to generate a pattern of
      beats. </P>

    <p style="align-items:left; padding:0px; font-size:24">
      The beat pattern is indicated by ones and zeros - ones indicate that
      you must tap, and zeros indicate that you pause, or withhold your tap
      until the next beat. For example, a rhythm of tap-tap-pause will be
      indicated as 1-1-0.</p>

    <p style="align-items:left; padding:0px; font-size:24">
      In this exercise and in others in the experiment, you will need to
       tap out the specified rhythm repeatedly and with a specific tempo, 
       or rate of tapping.</p>

    <p style="align-items:left; padding:0px; font-size:24">
      When you are ready to try it, scroll to the
      next section or select Training from the menu at the top of the screen.</p>
  </section>

  <section id="training">
    <h1>Training: Level 1</h1>
    <div class="spacer">
      <p style="align-items:left; padding:0px">
        Welcome to your training. This is where you will learn to tap out a
        rhythm using your foot pedal.</p>

      <p  style="align-items:left; padding:0px">
        You should hear a metronome*. The clicks of the metronome dictate the
        tempo, or the rate, that you should tap. </p>

      <p>
          Below is an example. Try tapping out the sequence. You will see
          the timing of your taps appear in the chart below, which already
          shows an ideal example of what your taps should look like. Stop
          only once a pop-up window indicates that you have completed the trial.
          When you have completed the trial, scroll to the next Training Level.
      </p>

      <h3 id="next_text_sequence">1 1 0</h3>

      <div class="chart-container" style="position: relative;     height:15vh; width:50vw">
          <canvas id="tapTime-chart"></canvas>
      </div>
      <div id="plot"></div>

      <div class="footnote">
        <p> * If you do not hear the metronome,
        try adjusting your volume or ask the experimenter for help. To
        deactivate the metronome, select Toggle metronome. </p>
      </div>

      <!-- <div class="sticky-buttons">
        <button id="toggle_button">Toggle metronome</button>
      </div> -->
    </div>
  </section>

  <section id="training2">
    <h1>Training: Level 2</h1>
    <div class="spacer">
      <p style="align-items:left; padding:0px">
        Welcome to level 2 of your training.</p>

      <p  style="align-items:left; padding:0px">
        You will repeat the exercise from Level 1 but with a more complicated
        rhythm. Begin when you are ready, and once you have completed this trial,
        scroll to the next Training Level. </p>

      <h3 id="next_text_sequence2">1 1 0 1 0</h3>

      <div class="chart-container" style="position: relative;     height:15vh; width:50vw">
          <canvas id="tapTime-chart2"></canvas>
      </div>
      <div id="plot2"></div>
  </section>

  <section id="training3">
    <h1>Training: Level 3</h1>
    <div class="spacer">
      <p style="align-items:left; padding:0px">
        Welcome to level 3 of your training.</p>

      <p  style="align-items:left; padding:0px">
        You will repeat the exercise from Levels 1 & 2 but with an even more complicated
        rhythm. This is your final training round, so begin when you are ready and proceed
        to the Calibration section when you have completed this Level. </p>

      <h3 id="next_text_sequence3">1 0 1 1 0 1 0 0</h3>

      <div class="chart-container" style="position: relative;     height:15vh; width:50vw">
          <canvas id="tapTime-chart3"></canvas>
      </div>
      <div id="plot3"></div>
  </section>

  <section id="calibration">
    <h1>Calibration</h1>
      <div id="tap-task3" class="spacer" style="position:relative; top:0px">
      <h3>Rhythm keeping exercise.</h3>
      
      <p  style="align-items:left; padding:0px">
        Welcome to the Calibration section, where we will measure your baseline performance 
        at keeping rhythms. In this section, you will complete
        a series of exercises just like in the Training Levels, with the exception
        that there will not be graphical feedback showing your tap sequence or a metronome.
        The drop-down box below lists rhythm lengths from 3 to 7. Complete each length once, proceeding from 
        shortest to longest, and notify the experimenter when you have completed the Task.</p>
      
      <h3>Select a rhythm length.</h3>
      <select id="T2-selection" onchange="specify_beat_sequence()">
          <option value="default" selected>Select one</option>
          <option value="length3">Length 3</option>
          <option value="length4">Length 4</option>
          <option value="length5">Length 5</option>
          <option value="length6">Length 6</option>
          <option value="length7">Length 7</option>
      </select>
    </div>
    <div id="beat-sequence-display" style="display:none; position:relative; top:260px">
            <h3>
                Test.
            </h3>
        </div>
  </section>

  <!-- <section id="validation">
    <h1>Validation</h1>
    <h3 id="validation_tap_sequence" style="display:none">Your sequence: 1 0 1 1 0 1 0 0</h3>
    <div id="tap-task4" class="spacer" style="position:relative; top:0px">
      <h3>Select a rhythm length.</h3>
      <select id="validation-selection" onchange="specify_beat_sequence_validation()">
          <option value="default" selected>Select one</option>
          <option value="length1">Length 1</option>
          <option value="length3">Length 3</option>
          <option value="length4">Length 4</option>
          <option value="length5">Length 5</option>
          <option value="length6">Length 6</option>
          <option value="length7">Length 7</option>
          <option value="length8">Length 8</option>
          <option value="length9">Length 9</option>
          <option value="length10">Length 10</option>
      </select>
    </div>
    <div id="beat-sequence-display-validation" style="display:none; position:relative; top:1px">
      <h3>
          Test.
      </h3>
    </div>
    <div id="n-back-task" class="spacer">
      <h3>N-back task.</h3>
      <select id="T1-selection" onchange="specify_nback_level()">
          <option value="default" selected>Select one</option>
          <option value="n1">N = 1</option>
          <option value="n2">N = 2</option>
          <option value="n3">N = 3</option>
      </select>
      <div id = "n-back-instructions" style="display:none">
        <p>
            Pay attention to the numbers streaming below. When the same
            number is presented with a delay of N = 2, click the button below.
        </p>
      </div>
      <h3 id="n-back-number" style="display:none; margin-bottom:20px">0</h3>
      <input type="button" value="Match occured" onclick="increment()"
        style="margin-bottom:20px">
  </div>
  </section> -->

  <!-- Add the audio element for the beep sound -->
  <audio id="beepAudio" src="sounds/tic.m4a"></audio>

  <script>
    // Smooth scrolling
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        e.preventDefault();
        document.querySelector(this.getAttribute('href')).scrollIntoView({
          behavior: 'smooth'
        });
      });
    });
  </script>

  <script src="scripts/intersection_observer_script.js"></script>

  <script src="scripts/main_rhythm_keeping.js"></script>
</body>
</html>
